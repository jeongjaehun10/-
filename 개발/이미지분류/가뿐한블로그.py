import pandas as pd
import re
from collections import Counter
import tkinter as tk
from tkinter import filedialog

# tk 윈도우 생성
root = tk.Tk()
root.withdraw()  # 기본 창 숨기기
# 파일 대화상자 열기
excel_file_path = filedialog.askopenfilename()

# 엑셀 파일 읽기
df = pd.read_excel(excel_file_path)

# 'referer' 열의 값만 가져오기
referer_column = df['referer']

# referer_column 변수에는 'referer' 열의 값만 담긴 시리즈(Series)가 저장됩니다.
# 이를 데이터프레임으로 변환하려면 다음과 같이 합니다.

referer_df = referer_column.to_frame()

data_dict = {
    '223310525177': '몸이찌뿌둥 망가졌던 생활패턴 가뿐한베이스플러스로 돌려주기',
    '223310527467': '몸이찌뿌둥하면 먹기 좋은 영양제 가뿐한베이스플러스 추천',
    '223310531981': '지친 몸을 위한 피로회복영양제! 가뿐한베이스플러스',
    '223310534134': '몸이찌뿌둥한 군인들에게 좋은 가뿐한베이스플러스 추천',
    '223310662902': '찌뿌둥한 나를 위한 가뿐한베이스플러스 피로회복영양제',
    '223310721657': '가뿐한베이스플러스 피로회복영양제 직장인 필수템',
    '223313069183': '몸이찌뿌둥 피로회복엔 가뿐한베이스플러스 추천해요',
    '223312469631': '피로회복영양제로 추운겨울 가뿐한베이스플러스로 내 몸 지키기',
    '223313043469': '피로회복영양제로 딱 좋은 가뿐한베이스플러스 추천',
    '223313062212': '몸이찌뿌둥 언제 어느장소에서나 가뿐한베이스플러스',
    '223313006509': '몸이찌뿌둥 허약한 대학생이 추천하는 가뿐한베이스플러스',
    '223312980464': '피로회복영양제로 부모님 건강 챙겨드리기',
    '223316615499': '가뿐한베이스플러스 피로회복제 영양제로 바쁜 직장인들 컨디션 관리하세요!',
    '223316625166': '부모님에게 드리기 좋은 피로회복제 영양제 가뿐한베이스플러스!',
    '223316632571': '육아에 지친 부부들을 위한 가뿐한베이스플러스 피로회복제 영양제',
    '223318124928': '피로회복제 영양제는 첨가물 없는 가뿐한베이스플러스로!',
    '223319006315': '약국 피로회복 영양제 가뿐한베이스풀러스로 새해에 피로회복하자',
    '223319555695': '피로회복제 영양제 가뿐한베이스플러스로 부모님 건강 챙기기',
    '223323533367': '첨가물 없이 깔끔한 피로회복제 영양제! 가뿐한베이스플러스 선택',
    '223337491717': '몸이 찌뿌둥할때 꼭 챙겨야하는 카페인없는 가뿐한베이스플러스',
    '223338946522': '몸이찌뿌둥 할 때 카페인 많은 에너지음료대신 챙겨야하는 가뿐한베이스플러스',
    '223340014099': '야근으로 피로하고 몸이찌뿌둥할 때 가뿐한베이스플러스 챙겨 마셔',
    '223341344933': '몸이찌뿌둥 할 때 카페인 없는 건강차, 가뿐한베이스플러스로 관리',
    '223342053482': '몸이찌뿌둥 할 때 온가족 먹을 수 있는 건강차, 가뿐한베이스플러스',
    '223344756860': '남편피로 간편하게 챙길 수 있는 카페인 없는 건강차, 가뿐한베이스플러스',
    '223346290254': '남편피로에 에너지음료 대신할 제품 찾다가 찾은 가뿐한베이스플러스',
    '223347120018': '수험생피로 위해 에너지음료는 그만, 첨가물 없는 가뿐한베이스플러스로 관리하자',
    '223352793160': '몸이찌뿌둥 할 때를 대비해서 가뿐한베이스플러스 챙겼어요',
    '223352803433': '몸이찌뿌둥하고 감기피로가 있다면? 가뿐한베이스플러스로 관리해요',
    '223353864957': '날은 춥고 몸이찌뿌둥할 때 편안한 겨울을 보내기 위한 가뿐한베이스플러스',
    '223355274266': '딸이 재수 시작해서 약국피로회복제 가뿐한베이스플러스로 피로 관리 시작했어요',
    '223355855923': '찌뿌둥한 직장인 피로 개선하려고 가뿐한베이스플러스로 관리 시작했어요.',
    '223283299302': '수족냉증 때문에 일하면서 고생이라면? 가뿐한베이스플러스 드셔보세요',
    '223283308629': '수족냉증 증상 가뿐한베이스플러스 차 마시면서 데일리 케어',
    '223282944093': '직장인 피로회복제 까다롭게 고른 휴베이스 약국 가뿐한베이스플러스',
    '223283865994': '수족냉증 겪고있다면 관리부터 시작하자!',
    '223283754125': '직장인 피로회복에는 역시 가뿐한베이스플러스(feat.휴베이스 약국)',
    '223283870628': '직장인 피로회복으로 유명한 가뿐한베이스플러스, 휴베이스 약국에 있어요!',
    '223285369872': '수족냉증 두려워지는 겨울철 가뿐한베이스플러스로 따뜻하게 보내기',
    '223285353444': '직장인 피로회복제 너무 고마운 가뿐한베이스플러스',
    '223285340778': '직장인 피로회복제 가뿐한베이스플러스로 사랑받는 남편 되는법!',
    '223285841923': '피로회복에는 가뿐한베이스플러스, 상쾌한 아침 맞이하기',
    '223286272511': '피로회복으로 지친 몸 가뿐한베이스플러스로 해결하기',
    '223286280709': '연말 피로회복엔 가뿐한베이스플러스',
    '223289941379': '군인 남자친구 가뿐한베이스플러스로 피로회복 해주기',
    '223289941955': '힘들고 나에게 피로회복에 도움이 되는 가뿐한베이스플러스 선물하기',
    '223289927626': '추운 겨울 고생하는 군인들을 위한 가뿐한베이스플러스 피로회복 아이템 추천',
    '223289928803': '만성피로에 도움 되는 가뿐한베이스플러스 피로회복 제품 추천',
    '223290614293': '피로회복에 도움되는 액상차, 가뿐한베이스플러스를 남편에게 선물했어요.',
    '223290616456': '피로회복 제품 이것저것 알아보지 말고 가뿐한베이스플러스로 정착',
    '223290618260': '피로회복이 필요한 청소년기, 가뿐한베이스플러스로 건강관리 하기',
    '223291876015': '산후조리 피로회복 가뿐한베이스플러스로!',
    '223291802293': '피로회복에 도움이 되는 가뿐한베이스플러스 해외 출장 필수 아이템',
    '223291765257': '피로회복이 필요하다면 휴베이스 약국에서 꼭 구입해야 가뿐한베이스플러스',
    '223291836987': '피로회복에 도움이 되는 "가뿐한베이스플러스" 하나로 삶의 질 높이기',
    '223295966290': '피로회복엔 가뿐한베이스플러스 하나면 충분해요!',
    '223295922486': '피로회복 필요할 때 꼭 필요한 데일리 케어 가뿐한베이스플러스',
    '223295928989': '가뿐한베이스플러스로 피로회복하자!',
    '223295945187': '피로회복 필요할 시기라면? 가뿐한베이스플러스로!',
    '223295950807': '피로회복 어떻게 해야 할지 고민이라면 가뿐한베이스플러스로 해결하세요!',
    '223295973565': '피로회복 하지 않으면 힘든 분들을 위한 가뿐한베이스플러스',
    '223296651869': '피로회복 컨디션 관리가 필요할 때 가뿐한베이스플러스 찾자!',
    '223296670576': '피로회복에 좋은 가뿐한베이스플러스로 피로 해방!',
    '223296818799': '피로회복에 도움 되는 가뿐한베이스플러스 액상차 추천해요.',
    '223297966570': '자연재료로 만들어져 안심할 수 있는 가뿐한베이스플러스로 피로회복 하자',
    '223297954638': '피로회복 필요하다면!! 가뿐한베이스플러스',
    '223297960773': '피로회복  아이도 마실 수 있는 가뿐한베이스플러스로 꾸준히 관리하자',
    '223298565335': '몸이찌뿌둥 공시생 딸 좋은 컨디션 위해 찾은 가뿐한베이스플러스',
    '223299031964': '몸이찌뿌둥, 가뿐한베이스플러스로 새로운 해를 맞이하는 건강관리',
    '223299037280': '피로회복영양제 왜 고민만 하고 있어요! 가뿐한베이스플러스로 고민 해결하세요!!',
    '223299731425': '가뿐한베이스플러스 피로회복영양제로!! 아침에 일어나기 힘들다면',
    '223299729049': '피로회복영양제 찾다가 알게 된 가뿐한베이스플러스! 제대로 찾았네요. ',
    '223299727557': '몸이찌뿌둥 추위와 피로감을 이겨내는 가뿐한베이스플러스',
    '223304261961': '몸이찌뿌둥 부모님 건강도 가뿐한베이스플러스로 챙길 수 있어요.',
    '223304161367': '몸이찌뿌둥 열심히 살아가고 있다는 증거 가뿐한베이스플러스로 이겨내기',
    '223304295622': '국내산 자연재료로 만들어진 피로회복영양제, 가뿐한베이스플러스',
    '223304350043': '몸이찌뿌둥 만성피로도 극복할 수 있는 가뿐한베이스플러스',
    '223304312578': '맞벌이 부부 피로회복영양제로는 가뿐한베이스플러스!',
    '223304358662': '자연 재료로 만들어진 가뿐한베이스플러스 피로회복영양제로 만성피로 극복하기',
    '223304911337': '몸이찌뿌둥 잦은 회식으로 잃은 건강 가뿐한베이스플러스로 되찾기',
    '223304767962': '몸이찌뿌둥 피로감을 해소하기 위한 가뿐한베이스플러스',
    '223305360091': '피로회복영양제 찾고 계신다면? 가뿐한베이스플러스',
    '223305980641': '가뿐한베이스플러스 피로회복영양제로 망가진 몸 회복하기',
    '223305983210': '가뿐한베이스플러스 피로회복영양제로 만성피로 해결하기',
    '223305978121': '짧아지는 해로 몸이찌뿌둥 극복하기 위해선? 가뿐한베이스플러스',
    '223291386530': '피로회복에 좋은 영양제 추천 (가뿐한베이스플러스)',
    '223254840439': '수험생 피로회복, 컨디션 관리 해주고 싶다면',
    '223263181214': '군인 피로회복제 가뿐한베이스플러스 남자친구 선물로 좋아요',
    '223329893838': '가뿐한베이스플러스 약국 피로회복 영양제로 새해 건강관리 시작!',
    '223267033673': '가래 없애는 방법 꾸준히 관리해요',
    '223333566458': '가래가 생기는 이유와 색깔별 특징, 가래 없애는 방법',
    '223280177433': '약국 피로회복영양제 가격 먹는법 용법 성분 효과 총정리',
    '223284759477': '가래 없애는 방법, 목 칼칼 가래 생기는 이유',
    '223280293965': '만성피로에 찌든 예비신혼부부 가뿐한베이스플러스 플렉스한 후기',
    '223254997137': '공시생 컨디션관리, 공시 준비하는 언니에게 가뿐한베이스플러스 선물',
    '223254776245': '공시생 컨디션 관리, 가뿐한베이스플러스로 공시생 컨디션 관리 해요',
    '223255002650': '공시생 피로회복, 컨디션 관리, 가뿐한베이스플러스 공시 준비 체력 관리 마시면서 하자',
    '223255007328': '군인 피로회복은 가뿐한베이스플러스로 휴베이스약국에서 알아보세요.',
    '223255012833': '공시생 피로회복, 만성 피로 가볍게 마시면서 풀어요',
    '223254825591': '가뿐한베이스플러스를 우리 아들의 군인 피로회복제로 휴베이스약국에서 추천받았어요.',
    '223254831920': '가뿐한베이스플러스를 알게 된 휴베이스약국! 군인 피로회복제로 너무 딱이에요.',
    '223254836232': '수험생 피로회복, 컨디션 관리, 좋은 것만 챙겨주고 싶다면',
    '223254840439': '수험생 피로회복, 컨디션 관리 해주고 싶다면',
    '223254842750': '수험생 컨디션 관리, 피로, 가뿐하게 피로 덜어내기위해서는',
    '223257285803': '가뿐한베이스플러스 계속 찾게 되는 공시생 피로 회복, 컨디션 조절',
    '223257290493': '공시생 피로회복, 컨디션 관리에 가뿐한베이스플러스 공시생 피로회복제 선물로 추천해요',
    '223257293437': '공시생 컨디션 관리 제품, 초기 감기 몸살에 바로 잡아요',
    '223257299056': '군인 피로회복제 가뿐한베이스플러스 피로감을 싹 날려주는',
    '223257301585': '군인 피로회복제 가뿐한베이스플러스 피로 해소와 건강을 한 번에',
    '223257886274': '수험생 피로회복제 피로가 쌓이기 전에 챙기기',
    '223257800356': '수험생 피로회복제는 휴베이스 약국이 정답!',
    '223257562839': '수험생 피로회복제 컨디션 최상을 위해',
    '223257854088': '군인 피로회복제 군인들을 위한 가뿐한베이스플러스',
    '223257847664': '수험생 피로회복제 간편하게 챙기고 싶다면 선택!',
    '223259225650': '공시생 피로회복제 가뿐한베이스플러스로 피로 관리 해요',
    '223259205132': '공시생 피로회복제 공시 준비생 피로 회복 선물로 추천',
    '223259296858': '공시생 피로회복제 가뿐한베이스플러스 가볍게 마시며 피로 회복하기',
    '223259320325': '힘든 군인을 위한 군인 피로회복제',
    '223259606071': '수험생 피로회복제 챙겨주고 싶다면 가뿐한베이스 플러스',
    '223259555784': '수험생 피로회복제 이제 스스로 챙겨먹는 제품',
    '223259518729': '수험생 피로회복제 공부로 날밤을 새고 있길래 구입했어요',
    '223259860822': '수험생 피로회복제 수능 준비를 하는 아이를 위한 선택',
    '223259348289': '군인 피로회복제 가뿐한베이스플러스로 우리아이 건강관리',
    '223259280541': '수험생 피로회복제 우리집 필수템',
    '223259426969': '가뿐한베이스플러스로 휴베이스 약국에서 공시생 피로회복제 해결했어요.',
    '223259409987': '가뿐한베이스플러스! 공시생 피로회복제로 너무 좋아서 휴베이스약국에만 가요.',
    '223259534931': '공시생 피로회복제 가뿐한베이스플러스 피곤할 때 먹으면 딱이야!',
    '223259555368': '공시생 피로회복제 가뿐한베이스플러스로 관리하는 내 몸',
    '223259576413': '군인 피로회복제는 가뿐한베이스플러스로 챙기자!',
    '223259594795': '군인 남자친구를 위한 군인 피로회복제',
    '223259611847': '군인 피로회복제 가뿐한베이스플러스 언제 어디서나 건강 챙기기',
    '223259696935': '군인 피로회복제 가뿐한베이스플러스로 고생하는 군인 남자친구 챙겨주기',
    '223259832718': '수험생 피로회복제 수능을 준비하는 아이를 위하여',
    '223259811909': '군인들을 위한 가뿐한베이스플러스 군인 피로회복제',
    '223262147571': '공시생 피로회복제 가뿐한베이스플러스로 건강 챙기자!',
    '223262305466': '공시생 피로회복제 아들을 위한 작은 선물 가뿐한베이스플러스',
    '223262317754': '가뿐한베이스플러스 지친 몸을 달래주는 군인 피로회복제',
    '223263132034': '수험생 피로회복제 잠을 줄여가며 공부하고 있다면',
    '223263181214': '군인 피로회복제 가뿐한베이스플러스 남자친구 선물로 좋아요',
    '223263930354': '내 몸을 위해 공시생 피로회복제 드셔보시는 거 어떤가요?',
    '223263932156': '군인 피로회복제 가뿐한베이스플러스 건강을 챙기기 위해',
    '223263934056': '군인 피로회복제 가뿐한베이스플러스 군인 아들 선물해줬어요!',
    '223263938563': '수험생 피로회복제 긴장으로 잠을 제대로 못 자고 있다면',
    '223263923705': '수험생 피로회복제 몸 관리도 함께 하는 게 필요할 때',
    '223264663965': '지치고 힘든 수험생을 위한 공시생 피로회복제',
    '223264666243': '공시생 피로회복제 피곤에 지친 나를 위해 가뿐한베이스플러스',
    '223264669088': '군인 피로회복제 자연재료로 피로회복 든든하게',
    '223264671667': '군인 피로회복제 가뿐한베이스플러스 피로회복 가뿐하게',
    '223264674004': '수험생 피로회복제 섭취과 함께 응원하는 시험 준비',
    '223265432643': '공시생 피로회복제 가뿐한 베이스플러스 수험생에게 좋아요!',
    '223265504696': '공시생 피로회복제 찾고 계세요? 가뿐한베이스플러스 드셔보세요!',
    '223265653872': '수험생 피로회복제 엄마가 먼저 챙겨줘야하는 이유',
    '223265650994': '수험생 피로회복제 섭취으로 달고사는 우리아이 커피 끊게하자',
    '223265647755': '군인 피로회복제 군인 동생을 위한 누나의 선택!',
    '223267052176': '수험생 피로회복제 본인이 직접 인지하고 챙겨먹어야한다',
    '223267014072': '가뿐한베이스플러스 공시생 피로회복제 추천',
    '223267023923': '공시생 피로회복제 가뿐한베이스플러스 다양한 연령대가 섭취하는',
    '223267033673': '가뿐한베이스플러스 군인 아들 피로회복제 추천!',
    '223267043882': '수험생 피로회복제 조카 선물용으로도 제격인 제품',
    '223267617851': '공시생 피로회복제 가뿐한베이스플러스 어린아이도 섭취 가능한',
    '223267620069': '공시생 피로회복제 가뿐한베이스플러스 찾고 피로 안녕~',
    '223267623195': '가뿐한베이스플러스 군인 남친 피로회복에 도움받았어요!',
    '223267625409': '군인 피로회복제 가뿐한베이스플러스로 온 가족 건강 챙기기',
    '223267628244': '군인 피로회복제 가뿐한베이스플러스 지칠 때마다 하나씩 먹어요.',
    '223270267526': '공시생 피로회복제 가뿐한베이스플러스 많은 도움이 되었어요.',
    '223270293320': '군인 피로회복제 가뿐한베이스플러스 군인 건강관리 선물 추천',
    '223270476903': '자연성분으로 만든 공시생 피로회복제',
    '223270637019': '군인 피로회복제 가뿐한베이스플러스 떨어진 체력 끌어올리기',
    '223270309125': '공시생 피로회복제 가뿐한베이스플러스 선물로도 딱이야!',
    '223271006480': '공시생의 체력관리를 위한 공시생 피로회복제',
    '223271008346': '휴베이스 약국에서만 만날 수 있는 공시생 피로회복제',
    '223271011216': '공시생 피로회복제 체력이 고민이라면 선택',
    '223271442792': '군인 피로회복제 찌뿌둥할 때 찾는 제품',
    '223271451719': '가뿐한베이스플러스 공시생 피로회복제 휴베이스약국 들렀어요',
    '223271889522': '체력부터 면역력 강화까지 책임지는 공시생 피로회복제, 가뿐한베이스플러스',
    '223271895946': '만성피로에는 가뿐한베이스플러스! 군인남친 사주려다 내가 먹은 후기',
    '223271898722': '수족냉증에 좋은 가뿐한베이스플러스를 휴베이스 약국에서 추천받아 꾸준한 섭취를 하고 있어요.',
    '223271901977': '만성피로 공시생이 직접 구매해서 마셔본 가뿐한베이스플러스 후기',
    '223271851597': '수종냉증 더 심해지기 전에 휴베이스 약국에서 가뿐한베이스플러스를 들고 가세요.',
    '223273799872': '육아와 살림으로 만성피로 주부에게는 가뿐한베이스플러스를!',
    '223273802999': '만성피로 집중력까지 떨어진다면 가뿐한베이스플러스',
    '223273805968': '수족냉증으로 휴베이스 약국에서 가뿐한베이스플러스를 구매했어요',
    '223273808735': '수족냉증으로 고생하다가 드디어 휴베이스 약국에서 가뿐한베이스플러스로 해결!',
    '223275821925': '만성피로 날리고 싶다면 휴베이스 약국에서 가뿐한베이스플러스!',
    '223275557864': '만성피로에 지친 수험생에게 가뿐한베이스플러스를 선물하세요!',
    '223275571179': '만성피로로 힘들어하시는 부모님에게 가뿐한베이스플러스를 선물',
    '223275577443': '수족냉증이 고민이라면 가뿐한베이스플러스를 믿고 먹어보세요',
    '223275581555': '수족냉증으로 고민만 하다가 휴베이스 약국에서 가뿐한베이스플러스로 해결했어요',
    '223275585922': '만성피로로 힘들어하시는 부모님에게 가뿐한베이스플러스를 선물',
    '223276368803': '만성피로 남편에게 휴베이스 약국 가뿐한베이스플러스로 내조하기',
    '223276372854': '만성피로로 인해 쉽게 지치시지 않나요? 가뿐한베이스플러스로 해결하세요',
    '223276376185': '취업 후 만성피로로 힘들다면? 가뿐한베이스플러스',
    '223276380485': '수족냉증이랑 피로도 가뿐한베이스플러스로 한번에 안녕~!',
    '223276410359': '수족냉증으로 힘든 사람들 가뿐한베이스플러스에 주목해 보세요.',
    '223277782798': '가뿐한 베이스플러스로 만성피로 지친 몸 회복하기',
    '223277783649': '만성피로로 고생하시는 분들 주목할 제품! 가뿐한베이스플러스!',
    '223277784382': '가뿐한베이스플러스로 수족냉증 가볍게 해결하자~',
    '223277785186': '수족냉증, 가뿐한 베이스플러스 마시면서 손발 저림까지 곤리해 보자.',
    '223277786025': '수족냉증 있는 사람이라면 가뿐한베이스플러스 한 포!',
    '223278314962': '오랜 취업준비로 인해 만성피로로 지친 몸에는 가뿐한베이스플러스 ',
    '223278317637': '가뿐한베이스플러스로 만성피로 극복하고 건강한 몸 찾자',
    '223278320032': '만성피로로 고생하는 군인 남자친구에게 가뿐한베이스플러스 선물해주기',
    '223278322662': '만성피로로 고생하는 군인 남자친구 가뿐한베이스플러스로 챙겨주기',
    '223278325188': '만성피로로 지친 대학원생들의 필수템, 가뿐한베이스플러스',
    '223278795892': '수족냉증으로 겨울이 두렵다면 가뿐한베이스플러스로 해결',
    '223278788416': '수족냉증 추워지기 전에 가뿐한베이스플러스로 관리하자!',
    '223278773944': '수족냉증 관리하는 방법, 가뿐한베이스플러스라면 어렵지 않아요.',
    '223278761895': '수족냉증 있는 사람들 가뿐한베이스플러스를 챙겨먹어보자!',
    '223278750863': '수족냉증 걱정된다면 가뿐한베이스플러스',
    '223280269357': '만성피로 가뿐한베이스플러스로 해결해요',
    '223280293965': '만성피로에 찌든 예비신혼부부 가뿐한베이스플러스 플렉스한 후기',
    '223280283172': '온 가족 만성피로 도움이 되는 가뿐한베이스플러스 후기',
    '223280240966': '가뿐한베이스플러스로 수족냉증 고생길은 이제 안녕~!',
    '223282024796': '수족냉증으로 고생하는 부모님께 선물하고 싶은 가뿐한 베이스플러스 추천해요'
}

# "referer"에서 블로그 뒤의 숫자를 찾아 발생 횟수 계산
post_numbers = []
for cell in referer_df['referer']:
    cell_str = str(cell)
    match = re.search(r'blog\.naver\.com\/[^\/]+\/(\d+)', cell_str)
    if match:
        post_numbers.append(match.group(1))
    else:
        post_numbers.append(None)

# 발생 횟수 계산 및 데이터 저장
result_data = []
for post_number, count in Counter(post_numbers).items():
    title = data_dict.get(post_number, f'Unknown Post ({post_number})')  # data_dict에 없으면 "Unknown Post"로 표시
    result_data.append({'유입경로': title, 'Count': count})

df3 = pd.DataFrame(result_data)
df_sorted3 = df3.sort_values(by='Count', ascending=False)
print(df_sorted3)
excel_output_path = "가뿐한블로그.xlsx"
df_sorted3.to_excel(excel_output_path, index=False)
